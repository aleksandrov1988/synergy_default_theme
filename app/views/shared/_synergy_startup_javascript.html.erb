<%= javascript_include_tag 'http://cdn.jquerytools.org/1.2.5/all/jquery.tools.min.js' %>

<script type="text/javascript">
  $(function() {
    var cp_wrapper = $('#comparable_products_wrapper').detach();
    $('#tooltip_content').append(cp_wrapper);

    jtooltip = $('#compare_products').tooltip({
      position: 'bottom center',
      events: { def: 'none,none' },
      delay: 3000
    }).data('tooltip');

    $('#compare_products').click(function(e) {
      if (jtooltip.isShown()) {
        hideComparePopup();
      }
      else {
        showComparePopup();
      }
      e.preventDefault();
    });

    $("#compare_products").html("<%= t(:compare_products, :scope => :compare_products, :count => @comparable_products.count) %>");

    $("#compare_products_link a").addClass('button');
    $("#log_in_link").overlay({
      mask: {
        color: 'black',
        opacity: 0.3
      }
    });
  });

  function showComparePopup() {
    jtooltip.show();
    $("#compare_products").addClass('shown');
    compare_popup_timer = window.setTimeout(hideComparePopup, 3000);
  }

  function hideComparePopup() {
    jtooltip.hide();
    $("#compare_products").removeClass('shown');
    window.clearTimeout(compare_popup_timer);
  }

  function onAddCompareProduct() {
    showComparePopup();
  }
  function onRemoveCompareProduct() {
    showComparePopup();
  }
</script>
